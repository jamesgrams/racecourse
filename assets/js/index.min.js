var LOG_OUT_STRING="Logout",DEFAULT_ERROR="Sorry, an error has ocurred.",SAVE_ERROR_MESSAGE="Your data could not be saved. Please try again.",SAVE_SUCCESSFUL_MESSAGE="Save Successful",DELETE_SUCCESSFUL_MESSAGE="Delete Successful",DELETE_FAILED_MESSAGE="Delete Failed. Please try again.",loadedJs={};function enableAjaxLinks(){document.querySelectorAll(".ajax-link").forEach(function(t){t.onclick=function(e){e.preventDefault(),directPage(t.getAttribute("href"))}})}function directPage(n){makeRequest("GET",n,{ajax:1,webp:!!document.querySelector(".webp")},function(e){try{var t=JSON.parse(e);changePage(t.content,t.title,t.description,t.js,t.css,n)}catch(e){console.log(e),window.location=n}})}function createCacheObjectFromFullPage(){for(var e=document.querySelectorAll("script[src]"),t=[],n=0;n<e.length;n++)t.push(e[n].getAttribute("src")),loadedJs[e[n].getAttribute("src")]=!0;for(var r=document.querySelectorAll("link[type='text/css']"),o=[],n=0;n<r.length;n++)o.push(r[n].getAttribute("href"));return{content:document.querySelector("#content-wrapper").innerHTML,title:document.title,description:document.querySelector('meta[name="description"]').getAttribute("content"),js:t,css:o}}function changePage(e,t,n,r,o,a,i){for(var c=[],s=0;s<o.length;s++){document.querySelector("link[href='"+o[s]+"']")||((u=document.createElement("link")).setAttribute("rel","stylesheet"),u.setAttribute("type","text/css"),u.setAttribute("href",o[s]),c.push(u))}if(c.length)for(var l=c.length,s=0;s<c.length;s++){var u=c[s];document.getElementsByTagName("head")[0].appendChild(u),u.onload=function(){0==--l&&switchPage(e,t,n,r,o,a,i)}}else switchPage(e,t,n,r,o,a,i)}function switchPage(e,t,n,r,o,a,i){clearPageSpecificJS(),document.querySelector("#content-wrapper").innerHTML=e,document.title=t||"",document.querySelector('meta[name="description"]').setAttribute("content",n||""),i||window.history.pushState({content:e,title:t,description:n,js:r,css:o},t,a),addPageSpecificJS(r),enableAjaxLinks(),window.scrollTo(0,0),document.querySelector("body").setAttribute("data-path",a)}function addPageSpecificJS(e){var o=e.length,a=[];e.forEach(function(t){var n=t.match(/\/([a-z]+)\.min/)[1];n="load"+(n=n[0].toUpperCase()+n.slice(1));function e(){if(a.push(function(){try{window[n](),loadedJs[t]=!0}catch(e){}}),0==--o)for(var e=0;e<a.length;e++)a[e]()}var r;loadedJs[t]?e():((r=document.createElement("script")).src=t,r.onload=e,document.body.appendChild(r))})}function addFormInputEvents(t){t.querySelectorAll("input, textarea").forEach(function(e){e.value&&e.classList.add("value"),e.oninput=function(){this.value?e.classList.add("value"):e.classList.remove("value"),formErrorCheck(t,!0)},e.onfocus=function(){e.classList.add("looked-at")},e.onblur=function(){formErrorCheck(t,!0)}})}function formSubmit(e,r,o,t,a){e.preventDefault(),formErrorCheck(r,!1);var n=r.querySelector("input.invalid");if(n)return n.focus(),void document.querySelector("form").reportValidity();var i=r.querySelector("button:not(.close-modal)"),c=i.innerText;i.onclick=function(e){e.preventDefault()};var s=(new Date).getTime();i.classList.add("submitting");var l=setTimeout(function(){i.innerText="Submitting!"},1e3);if(!t){t={};for(var u=r.querySelectorAll("input,textarea"),d=0;d<u.length;d++)t[u[d].getAttribute("name")]=u[d].value}makeRequest("POST",r.getAttribute("data-endpoint"),t,function(e){var t=((new Date).getTime()-s)%2e3,n=1e3;clearTimeout(l),n<t&&(n+=2e3),setTimeout(function(){i.classList.remove("submitting"),i.classList.add("submitted"),i.innerText="Thank You!",a&&a(e),o&&directPage(o)},n-t)},function(e){i.onclick=function(e){formSubmit(e,r,o,null,a)},i.innerText=c,i.classList.remove("submitting"),clearTimeout(l);var t="An error has occurred. Please try again later.";try{var n=JSON.parse(e);n.errorMessage&&(t=n.errorMessage)}catch(e){}formDisplayError(r,t)})}function ensureProperFixedElementColor(e,t){for(var n=!1,r=document.elementsFromPoint(Math.floor(e.getBoundingClientRect().left)+e.clientWidth/2,Math.floor(e.getBoundingClientRect().top)+e.clientHeight/2),o=t;o<r.length;o++){var a=window.getComputedStyle(r[o],null).getPropertyValue("background-color").match(/rgba?\((\d+), (\d+), (\d+),?\s?(0?\.?\d+)?\)/);if(a&&"0"!=a[4]){200<parseInt(a[1])&&200<parseInt(a[2])&&200<parseInt(a[3])&&(e.classList.add("dark"),n=!0);break}}n||e.classList.remove("dark")}function getConsistentPath(e){return"/"==e.substring(e.length-1)&&1<e.length?e.substring(0,e.length-1):e}function clearPageSpecificJS(){try{window.removeEventListener("wheel",sectionScrollWheel,{passive:!1}),window.removeEventListener("touchstart",recordStartPosition,{passive:!1}),window.removeEventListener("touchmove",recordPosition,{passive:!1}),window.removeEventListener("touchend",sectionScrollTouch,{passive:!1})}catch(e){}window.onkeydown=null,document.body.onscroll=null}function formErrorCheck(e,t){var n="input, textarea";t&&(n="input.looked-at, textarea.looked-at");var r,o=e.querySelectorAll(n),a={required:[],pattern:[]},i=!1;o.forEach(function(e){t||e.classList.add("looked-at"),e.hasAttribute("required")&&!e.value?(t||a.required.push(e.nextSibling.innerText),i=!0,e.classList.add("invalid"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-describedby","form-error-message")):e.hasAttribute("pattern")&&!new RegExp(e.getAttribute("pattern")).test(e.value)?(t||a.pattern.push(e.nextSibling.innerText),i=!0,e.classList.add("invalid"),e.setAttribute("aria-invalid","true"),e.setAttribute("aria-describedby","form-error-message")):(e.classList.remove("invalid"),e.setAttribute("aria-invalid","false"),e.removeAttribute("aria-describedby"))}),i?t||(r=[],a.required.length&&r.push("Please include a "+grammaticalJoin(a.required)+"."),a.pattern.length&&r.push("Please use a valid "+grammaticalJoin(a.pattern)+"."),formDisplayError(e,grammaticalJoinSentances(r))):formClearError(e)}function grammaticalJoinSentances(e){for(var t=["Also","Additionally","Furthermore"],n=t,r=1;r<e.length;r++){0==n.length&&(n=t),e[r]=e[r].replace(/^\w/,function(e){return e.toLowerCase()});var o=Math.floor(Math.random()*n.length);e[r]=n[o]+", "+e[r],n.splice(o,1)}return e.join(" ")}function grammaticalJoin(e,t){if(!t)for(var n=0;n<e.length;n++)e[n]=e[n].toLowerCase();if(e.length)return 1==e.length?e[0]:2==e.length?e[0]+" and "+e[1]:(e[e.length-1]="and "+e[e.length-1],e.join(", "))}function formDisplayError(e,t){formClearError(e);var n=document.createElement("div");n.setAttribute("id","form-error-message"),n.setAttribute("aria-live","polite"),n.classList.add("error"),n.innerText=t,e.insertBefore(n,e.querySelector("button:not(.close-modal)"))}function formClearError(e){var t=e.querySelector(".error");t&&t.parentNode.removeChild(t)}function setActionButtons(e){var t=document.querySelector(".buttons");t.innerHTML="";for(var n=0;n<e.length;n++){var r=document.createElement("button");r.innerText=e[n].name,r.onclick=e[n].action,t.appendChild(r)}}function setUserName(e){try{if(e)throw new Error;var t=JSON.parse(decodeURIComponent(getCookieValue("racecourse-id")));document.querySelector(".user-name").innerText=t.first+" "+t.last}catch(e){document.querySelector(".user-name").innerText="",console.log(e)}}function createToast(e,t,n){var r=document.createElement("div");r.classList.add("toast"),n?r.innerHTML=e:r.innerText=e;var o=document.querySelector("main");!o&&(document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement)&&(o=document.querySelector(".screencast-wrapper")),(o=o||document.body).appendChild(r),setTimeout(function(){r.classList.add("toast-shown"),setTimeout(function(){r.classList.remove("toast-shown"),setTimeout(function(){r.parentElement.removeChild(r)},500)},4e3)},0)}function capitalizeFirstLetter(e){return e.charAt(0).toUpperCase()+e.slice(1)}function logout(){deleteCookies(),window.location="/login"}function isInViewport(e){var t=e.getBoundingClientRect();return 0<=t.top&&0<=t.left&&t.bottom<=(window.innerHeight||document.documentElement.clientHeight)&&t.right<=(window.innerWidth||document.documentElement.clientWidth)}function getCookieValue(e){var t=document.cookie.match("(^|;)\\s*"+e+"\\s*=\\s*([^;]+)");return t?t.pop():""}function deleteCookies(){document.cookie.split(";").forEach(function(e){document.cookie=e.replace(/^ +/,"").replace(/=.*/,"=;expires="+(new Date).toUTCString()+";path=/")})}function makeRequest(e,t,n,r,o,a){var i=Object.keys(n);if(("GET"==e||"DELETE"==e)&&i.length){for(var c=[],s=0;s<i.length;s++)c.push(i[s]+"="+n[i[s]]);t=t+(t.match(/\?/)?"&":"?")+c.join("&")}var l,u=new XMLHttpRequest;if(u.open(e,t,!0),"GET"!=e&&"DELETE"!=e&&i.length&&(a||u.setRequestHeader("Content-type","application/json")),u.onreadystatechange=function(){4==this.readyState&&(200==this.status?r&&r(this.responseText):o&&o(this.responseText))},"GET"!=e&&"DELETE"!=e&&Object.keys(n).length){if(a)for(var d in l=new FormData,n)l.append(d,n[d]);else l=JSON.stringify(n);u.send(l)}else u.send()}window.addEventListener("DOMContentLoaded",function(){var t=getConsistentPath(location.pathname)+location.search;window.onpopstate=function(e){changePage(e.state.content,e.state.title,e.state.description,e.state.js,e.state.css,t,!0)};var e=createCacheObjectFromFullPage();window.history.replaceState(e,"",t),enableAjaxLinks(),document.querySelector("body").setAttribute("data-path",t)}),window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),"function"!=typeof Object.assign&&Object.defineProperty(Object,"assign",{value:function(e){"use strict";if(null==e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!=r)for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(t[o]=r[o])}return t},writable:!0,configurable:!0});