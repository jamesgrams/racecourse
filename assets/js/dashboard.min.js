function loadDashboard(){setUserName();var e=[{name:LOG_OUT_STRING,action:logout}],a=JSON.parse(decodeURIComponent(getCookieValue("racecourse-id")));a.user?(a.is_global_admin&&e.unshift({name:"Admin",action:function(){directPage("/admin?type=user")}}),setActionButtons(e),makeRequest("GET","/api/class-user",{user_id:a.user},function(e){function o(){if(0==--t){for(var e=Object.keys(r).sort(),a=0;a<e.length;a++)document.querySelector(".dashboard").appendChild(r[e[a]]);n&&createToast(DEFAULT_ERROR)}}for(var a=JSON.parse(e).items,t=a.length,n=!1,r={},s=0;s<a.length;s++)!function(s){makeRequest("GET","/api/class",{id:s.class_id},function(e){var a=document.createElement("div");a.classList.add("dashboard-box");var t=JSON.parse(e),n=document.createElement("span");n.innerHTML=t.items[0].name,a.appendChild(n),a.onclick=function(){directPage("/class?id="+s.class_id+(s.is_admin?"&admin=1":""))},r[t.items[0].name]=a,o()},function(){n=!0,o()})}(a[s])},function(e){var a=DEFAULT_ERROR;try{var t=JSON.parse(e);t.errorMessage&&(a=t.errorMessage)}catch(e){}createToast(a)})):createToast(DEFAULT_ERROR)}window.addEventListener("DOMContentLoaded",loadDashboard);