function loadDashboard(){setUserName();var e=[{name:LOG_OUT_STRING,action:logout}],a=JSON.parse(decodeURIComponent(getCookieValue("racecourse-id")));a.user?(a.is_global_admin&&e.unshift({name:"Admin",action:function(){directPage("/admin")}}),setActionButtons(e),makeRequest("GET","/api/class-user",{user_id:a.user},function(e){function s(){if(0==--t){for(var e=Object.keys(i).sort(),a=0;a<e.length;a++)document.querySelector(".dashboard").appendChild(i[e[a]]);o&&createToast(DEFAULT_ERROR)}}for(var a=JSON.parse(e).items,t=a.length,o=!1,i={},n=0;n<a.length;n++)!function(n){makeRequest("GET","/api/class",{id:n.class_id},function(e){var a=document.createElement("div");a.classList.add("dashboard-box");var t=JSON.parse(e);a.innerHTML=t.items[0].name,a.onclick=function(){directPage("/class?id="+n.class_id+(n.is_admin?"&admin=1":""))},i[t.items[0].name]=a,s()},function(){o=!0,s()})}(a[n])},function(e){var a=DEFAULT_ERROR;try{var t=JSON.parse(e);t.errorMessage&&(a=t.errorMessage)}catch(e){}createToast(a)})):createToast(DEFAULT_ERROR)}window.addEventListener("DOMContentLoaded",loadDashboard);